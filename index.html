<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Twitch Extension Insight Graphs</title>

        <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self' 'unsafe-eval' https://d3js.org; disown-opener; connect-src https://api.twitch.tv">

        <script src="https://d3js.org/d3.v5.min.js" integrity="sha384-Nth41CoN2s0hj2li43h7cs5a1J0zroMLa7ugSGFSdWJMF1OuKrJwZaritPHBnk3E" crossorigin="anonymous"></script>
        <script src="https://d3js.org/d3-dsv.v1.min.js" integrity="sha384-G/U6wDKkmUnIO3q8a9gvxSkUyOOZe+gmdI+T+AuTOiG12qjb2TnaveFMSf0hyHNl" crossorigin="anonymous"></script>
        <script src="https://d3js.org/d3-array.v1.min.js" integrity="sha384-eNoN1QUquT7+e3vJmaXeE4NReeo65Lso043hmS4Btr3vnaCjL8YORqqdXrnOY/zM" crossorigin="anonymous"></script>
        <script src="https://d3js.org/d3-time.v1.min.js" integrity="sha384-MvaIFqKkrZcImpOFU8lHtjSCy7ULHcpDupKkYyBmeMWpU5jexjlIOTMF19kPxue/" crossorigin="anonymous"></script>
        <script src="https://d3js.org/d3-time-format.v2.min.js" integrity="sha384-EFZCSQLPI8D7uiGPdxg764v6bIKF8yHW+hHuwKsGixqEJ6xjPKrnQfn+MDp/NnQ0" crossorigin="anonymous"></script>
        <script src="https://d3js.org/d3-color.v1.min.js" integrity="sha384-kz8mf8BgLbK6aKg7Vmj2j5bCdes6x93ak7Ttm76UI+25dxGbsXunHpWBAFu0uXiN" crossorigin="anonymous"></script>
        <script src="https://d3js.org/d3-interpolate.v1.min.js" integrity="sha384-5ruSWkAcYfur9CHThi1pqpZnlMwgxsw7MBP2/ZTu6LQIL5IXyfVGgll6EtYtRZVC" crossorigin="anonymous"></script>
        <script src="https://d3js.org/d3-scale-chromatic.v1.min.js" integrity="sha384-u/018p7+HijcQ9bz43IyOpIynI4ovlsWs14LpPsQzzttuoSD2s8GU9v23P/Qv82I" crossorigin="anonymous"></script>
        <script src="index.js" defer></script>
        <script src="extensions.js" async defer></script>
    </head>
    <body>
        <section id="extensions">
            <h2>Quick CSV download links</h2>
            <p><button id="login">Login</button> <button id="refresh" hidden>Refresh</button></p>
            <ul>
            </ul>
        </section>
        <section id="graphs">
            <h2>Graphs</h2>
            <section>
                <label for="source">Stats CSV:</label><input id="source" type="file" accept="text/csv">
            </section>
            <section>
                <label for="stat">Add Line:</label><select id="stat">
                    <option value="">Select data line</option>
                    <optgroup label="Twitch Data" disabled id="statgroup">
                    </optgroup>
                    <optgroup label="Calculated Stats" disabled id="calcgroup">
                        <option>Installed Channels</option>
                        <option>Linked Accounts</option>
                        <option>Install Rate</option>
                        <option>Renders per Viewer</option>
                    </optgroup>
                </select>
            </section>
            <svg width="960" height="500"></svg>
        </section>
        <section id="stats">
            <h2>Stats</h2>
            <p>Estimated installs: <output id="installs"></p>
            <p>Unique active channels: <output id="active"></p>
            <p>Estimated linked accounts: <output id="linkedAccounts"></p>
            <p>Currently live channels: <output id="liveCount"></p>
        </section>
        <footer>
            <h2>Info</h2>
            <p>Press F12 to see errors</p>
            <p>This is fully client-side, nothing ever touches a 3rd party server.</p>
            <p>"Installed Channels" and "Linked Accounts" are estimated numbers based on the two corresponding addition and removal numbers.</p>
            <p>"Install Rate" and "Renders per Viewer" are ratios calculated from Installs over Extension Details Page Visits and Renders over Unique Viewers respectivelly.</p>
            <p><a href="https://github.com/freaktechnik/extension-insights-graphs">GitHub repo</a></p>
        </footer>
        <section>
            <h2>Recent Changes</h2>
            <ul>
                <li>Added dots at the individual data points with tooltips containing the date and exact value</li>
                <li>Added "Renders per Viewer" and "Install Rate" calculated stats</li>
                <li>Added "Currently live channels" count</li>
                <li>Added "Installed Channels" and "Linked Accounts" calculated stats</li>
            </ul>
    </body>
</html>
